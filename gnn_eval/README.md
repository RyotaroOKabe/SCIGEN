
# GNN_EVAL

**GNN-based classification models to screen materials generated by SCIGEN.**  
This repository provides implementations of Graph Neural Network (GNN) models to evaluate and classify materials generated by SCIGEN. These models focus on tasks such as distinguishing pristine and diffused structures, identifying materials with low formation energy, and predicting magnetic properties.

---

## Models Overview
The models are built based on the following architectures:
- **[VGNN](https://www.nature.com/articles/s43588-024-00661-0)**: Virtual Node Graph Neural Network for material classification.
- **[E3NN PDOS](https://onlinelibrary.wiley.com/doi/10.1002/advs.202004214)**: Equivariant Neural Network for phonon density of states (PDOS).
- **[E3NN Magnetic Order](https://www.sciencedirect.com/science/article/pii/S258900422201464X)**: Equivariant Neural Network for predicting magnetic ordering.

---

## Dependencies
Ensure you have the following libraries installed before running the models:
```bash
python==3.9.20   
torch==2.0.1+cu118   
torch-geometric==2.3.0   
e3nn==0.5.1
plotly==5.3.1
pandas==2.0.2
pymatgen==2024.2.23
mp_api==0.41.1
mendeleev==0.14.0
seaborn==0.12.2
wandb===0.16.4
sklearn
matplotlib   
```

---

## Instructions for Training    

### [1] Configuration Setting   
Duplicate `config_eval_template.py` and rename it as `config_eval.py`. Modify the environment variables in the file:  
- `api_key`: MP_API Key.  
- `matbench_data_dir`: Path to a folder where you store Matbench Discovery data (required for `train_stab_ehull.py`): [Figshare link](https://doi.org/10.6084/m9.figshare.22715158.v19).  

### [2] Download the Training Dataset  
Download the training dataset from the [Figshare link](https://doi.org/10.6084/m9.figshare.27887097) and store it in `gnn_eval/data/`.  

### [3] GNN for Classifying Pristine and Diffused Structures  
This model classifies whether a material structure is pristine or diffused.
```bash
python train_stab_diff.py
```

### [4] GNN for Classifying Materials with Formation Energy Below 0.1 eV  
This model identifies materials with energy above the convex hull (`ehull`) below 0.1 eV. Pre-trained model is available [here](https://doi.org/10.6084/m9.figshare.27887097).    
```bash
python train_stab_ehull.py
```

### [5] GNN for Classifying Magnetic and Non-Magnetic Materials  
This model predicts whether a material is magnetic/non-magnetic. Pre-trained model is available [here](https://doi.org/10.6084/m9.figshare.27887097).     
```bash
python train_mag.py
```

---

## Contribution
Contributions are welcome! If you encounter any issues or have suggestions for improvement, feel free to open an issue or submit a pull request.

---

## Contact
For questions or support, please reach out to **Ryotaro Okabe** at **rokabe [at] mit [dot] edu**.  
